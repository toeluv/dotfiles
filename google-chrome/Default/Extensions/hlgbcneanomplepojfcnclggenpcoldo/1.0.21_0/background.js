let searchFocus,lastResult,currStatus={isInFlight:!1};chrome.runtime.onConnect.addListener((function(e){"popup"===e.name&&e.onDisconnect.addListener((function(){currStatus.isInFlight&&fetch("https://342251b-beta.perplexity.ai/api/342251b",{headers:{accept:"*/*","content-type":"application/json"},body:JSON.stringify({type:"event",payload:{website:"39c5923d-8ff2-48ed-97b7-603cc0ef89c9",hostname:"www.perplexity.ai",screen:"430x600",language:"en-US",url:"/",event_name:"ABORT",event_data:{isBrowserExtension:!0}}}),method:"POST",mode:"cors",credentials:"omit"}).then()}))})),chrome.runtime.onMessage.addListener(((e,t,s)=>{"string"==typeof e||e instanceof String?"query-started"===e?(currStatus.isInFlight=!0,lastResult=void 0):"query-complete"===e&&(currStatus.isInFlight=!1):"set-search-focus"===e.type?searchFocus=e.focus:"get-search-focus"===e.type?s(searchFocus??"internet"):"set-last-result"===e.type?lastResult=e.lastResult:"get-last-result"===e.type&&s(lastResult)}));